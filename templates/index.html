<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI 기반의 인프라 및 자격 증명 변경 통제</title>
    <link rel="stylesheet" href="../static/css/main.css">
</head>
<body>
    <!-- Header -->
    <div class="header">
        <svg class="header-icon" fill="currentColor" viewBox="0 0 24 24">
            <!-- ---<path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/> -->
            <img src="../static/img/logo.webp" alt="logo" height="30" width="30" />
        </svg>
        <h1>Minecraft Bedrock Version</h1>
    </div>

    <!-- Main Container -->
    <div class="container">
        <!-- Progress Steps -->
        <div class="card">
            <div class="progress-container" id="progressSteps">
                <!-- Populated by JavaScript -->
            </div>
        </div>

        <!-- Content Area -->
        <div class="card content-area">
            <!-- Step 0: User Configuration -->
            <div class="step-content-wrapper active" id="step-0">
                <h2 class="section-title">인프라 구성 설정</h2>
                <p class="section-description">새로 생성할 인프라의 설정을 입력해주세요</p>

                <div class="form-group">
                    <label class="form-label" for="region">AWS 리전</label>
                    <select class="form-select" id="region">
                        <option value="">리전을 선택하세요</option>
                        <option value="us-east-1">US East (N. Virginia)</option>
                        <option value="us-west-2">US West (Oregon)</option>
                        <option value="ap-northeast-2">Asia Pacific (Seoul)</option>
                        <option value="ap-northeast-1">Asia Pacific (Tokyo)</option>
                        <option value="eu-west-1">Europe (Ireland)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label" for="infrastructureType">인프라 타입</label>
                    <select class="form-select" id="infrastructureType">
                        <option value="">인프라 타입을 선택하세요</option>
                        <option value="ec2">EC2 Instance</option>
                        <option value="lambda">Lambda Function</option>
                        <option value="rds">RDS Database</option>
                        <option value="s3">S3 Bucket</option>
                        <option value="ecs">ECS Container</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label" for="description">인프라 설명</label>
                    <textarea class="form-textarea" id="description" rows="4" placeholder="생성하려는 인프라에 대한 설명을 입력하세요..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label" for="iamCredentials">IAM 자격 증명 ARN</label>
                    <input class="form-input" type="text" id="iamCredentials" placeholder="arn:aws:iam::123456789012:user/username">
                    <p class="form-hint">사용자의 IAM 자격 증명을 입력하세요</p>
                </div>
            </div>

            <!-- Step 1: CLI Generation -->
            <div class="step-content-wrapper" id="step-1">
                <h2 class="section-title">AI 기반 CLI 생성</h2>
                <p class="section-description">AI가 입력된 설정을 기반으로 IAM 정책과 CLI 명령어를 생성합니다.</p>

                <div class="generate-container" id="generateContainer">
                    <div style="text-align: center;">
                        <p style="font-size: 18px; margin-bottom: 8px;">AI를 사용하여 보안 정책과 CLI 명령어를 자동 생성합니다</p>
                        <p class="form-hint">생성된 명령어는 검토 후 수정할 수 있습니다</p>
                    </div>
                    <button class="btn btn-primary btn-lg" onclick="generateCLI()" id="generateBtn">
                        CLI 생성하기
                    </button>
                </div>

                <div class="generated-content" id="generatedContent">
                    <div style="display: flex; align-items: center; gap: 8px; color: #16a34a; margin-bottom: 16px;">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <span style="font-weight: 500;">AI 생성 완료</span>
                    </div>

                    <div style="background: #F9FAFB; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h3 style="font-weight: 600;">생성된 IAM 정책 (JSON)</h3>
                            <span class="badge badge-secondary">AI 생성</span>
                        </div>
                        <pre class="code-block" id="generatedJSON"></pre>
                    </div>

                    <div style="background: #F9FAFB; padding: 16px; border-radius: 8px; margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <h3 style="font-weight: 600;">생성된 CLI 명령어</h3>
                            <span class="badge badge-secondary">AI 생성</span>
                        </div>
                        <pre class="code-block" id="generatedCLI"></pre>
                    </div>

                    <div style="text-align: right;">
                        <button class="btn btn-secondary" onclick="regenerateCLI()">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>
                            </svg>
                            재생성
                        </button>
                    </div>
                </div>
            </div>

            <!-- Step 2: Vulnerability Analysis -->
            <div class="step-content-wrapper" id="step-2">
                <h2 class="section-title">취약점 분석</h2>
                <p class="section-description">AI가 Attack Graph를 생성하여 잠재적 보안 위험을 분석합니다.</p>

                <div id="analysisProgress">
                    <div class="card" style="padding: 24px; background: #F9FAFB;">
                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 16px;">
                            <svg width="24" height="24" fill="#FF9900" viewBox="0 0 24 24" class="spinner">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z" opacity="0.3"/>
                                <path d="M12 2v4c3.31 0 6 2.69 6 6h4c0-5.52-4.48-10-10-10z"/>
                            </svg>
                            <div>
                                <h3 style="font-weight: 600; margin-bottom: 4px;">Attack Graph 생성 중...</h3>
                                <p style="font-size: 14px; color: #6B7280;">기존 인프라와 새 리소스 간의 공격 경로를 분석하고 있습니다</p>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-bar-fill" id="analysisProgressBar" style="width: 0%"></div>
                        </div>
                        <p style="text-align: center; font-size: 13px; color: #6B7280; margin-top: 8px;" id="progressText">0% 완료</p>
                    </div>
                </div>

                <div id="analysisResults" class="hidden">
                    <div class="alert alert-info">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <div>
                            <p style="font-weight: 500; margin-bottom: 4px;">분석 완료</p>
                            <p style="font-size: 14px;">총 3개의 잠재적 취약점이 발견되었습니다</p>
                        </div>
                    </div>

                    <div id="vulnerabilityList"></div>
                </div>
            </div>

            <!-- Step 3: Execution -->
            <div class="step-content-wrapper" id="step-3">
                <h2 class="section-title">실행</h2>
                <p class="section-description">생성된 CLI 명령어를 실행하고 보안 모니터링을 진행합니다.</p>

                <div class="alert alert-info">
                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
                    </svg>
                    <div>
                        <p><strong>보안 프로세스:</strong> 임시 IAM 자격 증명이 생성되고, AI가 생성했음을 로깅합니다. 
                        리소스 생성 후 CloudTrail 로그를 검증하여 비정상적인 활동을 탐지하고, 작업 완료 후 임시 자격 증명을 자동으로 삭제합니다.</p>
                    </div>
                </div>

                <div id="executionIdle">
                    <div class="generate-container">
                        <svg width="64" height="64" fill="#9CA3AF" viewBox="0 0 24 24">
                            <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                        </svg>
                        <div style="text-align: center;">
                            <p style="font-size: 18px; font-weight: 500; margin-bottom: 8px;">실행 준비 완료</p>
                            <p style="font-size: 14px; color: #6B7280;">아래 버튼을 클릭하여 보안 프로세스를 시작하세요</p>
                        </div>
                        <button class="btn btn-primary btn-lg" onclick="executeProcess()">
                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M8 5v14l11-7z"/>
                            </svg>
                            실행하기
                        </button>
                    </div>
                </div>

                <div id="executionSteps" class="hidden">
                    <div class="card" style="padding: 16px; margin-bottom: 16px;" id="stepsContainer">
                        <!-- Populated by JavaScript -->
                    </div>

                    <div class="alert alert-success hidden" id="executionComplete">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                        </svg>
                        <div>
                            <p><strong>실행 완료:</strong> 모든 보안 프로세스가 성공적으로 완료되었습니다. 
                            임시 IAM 자격 증명은 안전하게 삭제되었으며, 모든 활동이 로깅되었습니다.</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 4: Logging -->
            <div class="step-content-wrapper" id="step-4">
                <h2 class="section-title">로깅 및 모니터링</h2>
                <p class="section-description">모든 활동이 기록되고 CloudTrail 로그와 비교 검증됩니다.</p>

                <div class="stats-grid">
                    <div class="card stat-card">
                        <div class="stat-icon blue">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                            </svg>
                        </div>
                        <div>
                            <p style="font-size: 13px; color: #6B7280;">총 활동</p>
                            <p style="font-size: 28px; font-weight: 600;">4</p>
                        </div>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon green">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                            </svg>
                        </div>
                        <div>
                            <p style="font-size: 13px; color: #6B7280;">검증 완료</p>
                            <p style="font-size: 28px; font-weight: 600;">4</p>
                        </div>
                    </div>

                    <div class="card stat-card">
                        <div class="stat-icon orange">
                            <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4z"/>
                            </svg>
                        </div>
                        <div>
                            <p style="font-size: 13px; color: #6B7280;">보안 경고</p>
                            <p style="font-size: 28px; font-weight: 600;">0</p>
                        </div>
                    </div>
                </div>

                <div class="tabs">
                    <div class="tab-list">
                        <button class="tab-button active" onclick="switchTab('ai-logs')">AI 로그</button>
                        <button class="tab-button" onclick="switchTab('cloudtrail')">CloudTrail</button>
                        <button class="tab-button" onclick="switchTab('alerts')">보안 알림</button>
                    </div>

                    <div class="tab-content active" id="tab-ai-logs">
                        <div class="card">
                            <div class="scroll-area" id="aiLogsContent">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="tab-cloudtrail">
                        <div class="card">
                            <div class="scroll-area" id="cloudtrailContent">
                                <!-- Populated by JavaScript -->
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" id="tab-alerts">
                        <div class="card" style="padding: 16px;" id="alertsContent">
                            <!-- Populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Buttons -->
        <div class="navigation">
            <button class="btn btn-secondary btn-lg" id="prevBtn" onclick="previousStep()">
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                </svg>
                이전
            </button>
            <button class="btn btn-primary btn-lg" id="nextBtn" onclick="nextStep()">
                다음
                <svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                </svg>
            </button>
        </div>
    </div>

    <script src="../static/js/main.js"></script>
</body>
</html>
