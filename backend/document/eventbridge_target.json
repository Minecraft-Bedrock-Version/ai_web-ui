{
  "platform": {
    "name": "MBV_Project",
    "scenario": "eventbridge_target",
    "reference": "https://github.com/Minecraft-Bedrock-Version/attack-scenario/tree/main/eventbridge_target"
  },

  "vulnerability_title": "EventBridge Rule 및 Target 조작을 통한 권한 상승",

  "category": [
    "EventBridge Rule 권한 오남용",
    "EventBridge Target 권한 오남용"
  ],

  "vulnerability_detail": "본 시나리오는 정책 변경 권한을 보유한 AWS Lambda 함수가 EventBridge에 의해서만 트리거 가능하도록 리소스 기반 정책이 설정된 환경을 전제로 합니다. 해당 Lambda 함수는 기존에 EventBridge Rule을 통해 호출되도록 구성되어 있습니다. 공격자는 호출 권한을 보유하지 않아도 events:PutRule, events:PutTargets 권한을 가진 AWS IAM User의 자격증명을 탈취하여 다음의 동작이 가능합니다. 기존 Rule과는 별도의 새로운 EventBridge Rule을 생성하고, Target의 Input 값을 변조하여 Lambda 함수를 실행시킵니다. 이때, Lambda 함수에서 일어나는 동작은 lambda:ListFunctions, lambda:GetFunction 권한을 통해 코드를 확인하여 악의적인 의도의 값으로 변조할 수 있습니다. Lambda 함수는 정상적인 이벤트로 인식하여 공격자가 변조한 동작을 수행하게 되며, 현재 Lambda 함수에 연결된 역할이 iam:AttachUserPolicy를 갖고있는 것으로 보아 간접적으로 정책을 부여받는 권한 상승(Privilege Escalation)의 위험이 존재할 것으로 예측 가능합니다.",

  "attack_path": [
    {
      "step": "IAM User(normal) → Eventbridge Rule & Target",
      "detail": "Inline Policy events:PutRule, events:PutTargets"
    },
    {
      "step": "IAM User(normal) → Lambda Function",
      "detail": "Inline Policy lambda:ListFunctions, lambda:GetFunction"
    },
    {
      "step": "Eventbridge Rule → Lambda Function",
      "detail": "Eventbridge Target"
    },
    {
      "step": "Lambda Function → IAM User(normal) Policy",
      "detail": "Role iam:AttachUserPolicy"
    }
  ]
}