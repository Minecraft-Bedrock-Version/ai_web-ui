[
    {
        "id": 1,
        "title": "sqs_flag_shop",
        "description": "document/sqs_flag_shop.json",
        "resources": [
          {
  "schema_version": "1.5",
  "nodes": [
    {
      "node_id": "288528695623:us-east-1:igw:igw-0c177eff04906d5d1",
      "type": "igw",
      "name": "cg-cgidic93dfr9ab",
      "properties": {
        "attached_vpc_id": "vpc-0fbb125c943a6257e",
        "state": "available"
      }
    },
    {
      "node_id": "288528695623:us-east-1:lambda:cache-charge-cgidic93dfr9ab",
      "type": "lambda",
      "name": "cache-charge-cgidic93dfr9ab",
      "properties": {
        "event_source_arn": "arn:aws:sqs:us-east-1:288528695623:cash_charging_queue"
      }
    },
    {
      "node_id": "288528695623:us-east-1:rds:terraform-20260131054208949500000003",
      "type": "rds_instance",
      "name": "cash"
    },
    {
      "node_id": "288528695623:iam_role:cg-sqs-lambda-cgidic93dfr9ab",
      "type": "iam_role",
      "name": "cg-sqs-lambda-cgidic93dfr9ab",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ]
        },
        "inline_policies": [],
        "attached_policies": [
          {
            "PolicyName": "AWSLambdaSQSQueueExecutionRole",
            "Statement": [
              {
                "Action": [
                  "sqs:ReceiveMessage",
                  "sqs:DeleteMessage",
                  "sqs:GetQueueAttributes",
                  "logs:CreateLogGroup",
                  "logs:CreateLogStream",
                  "logs:PutLogEvents"
                ],
                "Effect": "Allow",
                "Resource": "*"
              }
            ]
          },
          {
            "PolicyName": "AWSLambdaVPCAccessExecutionRole",
            "Statement": [
              {
                "Action": [
                  "logs:CreateLogGroup",
                  "logs:CreateLogStream",
                  "logs:PutLogEvents",
                  "ec2:CreateNetworkInterface",
                  "ec2:DescribeNetworkInterfaces",
                  "ec2:DescribeSubnets",
                  "ec2:DeleteNetworkInterface",
                  "ec2:AssignPrivateIpAddresses",
                  "ec2:UnassignPrivateIpAddresses"
                ],
                "Effect": "Allow",
                "Resource": "*"
              }
            ]
          }
        ]
      }
    },
    {
      "node_id": "288528695623:us-east-1:sqs:cash_charging_queue",
      "type": "sqs",
      "name": "cash_charging_queue"
    },
    {
      "node_id": "288528695623:us-east-1:ec2:i-073125a3321d8d939",
      "type": "ec2",
      "name": "cg-linux-ec2-cgidic93dfr9ab"
    },
    {
      "node_id": "288528695623:iam_role:cg-sqs-send-message-cgidic93dfr9ab",
      "type": "iam_role",
      "name": "cg-sqs-send-message-cgidic93dfr9ab",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "AWS": "arn:aws:iam::288528695623:user/cg-sqs-user-cgidic93dfr9ab"
              }
            }
          ]
        },
        "inline_policies": [
          {
            "PolicyName": "cg-sqs",
            "Statement": [
              {
                "Action": [
                  "sqs:GetQueueUrl",
                  "sqs:SendMessage"
                ],
                "Effect": "Allow",
                "Resource": "arn:aws:sqs:us-east-1:288528695623:cash_charging_queue"
              }
            ]
          }
        ],
        "attached_policies": []
      }
    }
  ],
  "edges": [
    {
      "id": "edge:cg-sqs-lambda-cgidic93dfr9ab:IAM_ROLE_ACCESS_EC2:i-073125a3321d8d939",
      "src": "288528695623:iam_role:cg-sqs-lambda-cgidic93dfr9ab",
      "dst": "288528695623:us-east-1:ec2:i-073125a3321d8d939",
      "relation": "IAM_ROLE_ACCESS_EC2",
      "directed": true,
      "conditions": "This role gives you access to EC2."
    },
    {
      "id": "edge:cg-sqs-send-message-cgidic93dfr9ab:IAM_ROLE_ACCESS_SQS:cash_charging_queue",
      "src": "288528695623:iam_role:cg-sqs-send-message-cgidic93dfr9ab",
      "dst": "288528695623:us-east-1:sqs:cash_charging_queue",
      "relation": "IAM_ROLE_ACCESS_SQS",
      "directed": true,
      "conditions": "This role gives you access to SQS Queue."
    },
    {
      "id": "edge:cash_charging_queue:SQS_TRIGGER_LAMBDA:cache-charge-cgidic93dfr9ab",
      "src": "288528695623:us-east-1:sqs:cash_charging_queue",
      "dst": "288528695623:us-east-1:lambda:cache-charge-cgidic93dfr9ab",
      "relation": "SQS_TRIGGER_LAMBDA",
      "directed": true,
      "conditions": "I found the SQS Queue ARN in the Event Source Mapping of this Lambda function."
    },
    {
      "id": "edge:cg-sqs-user-cgidic93dfr9ab:IAM_USER_ACCESS_IAM:scp_test",
      "src": "288528695623:iam_user:cg-sqs-user-cgidic93dfr9ab",
      "dst": "288528695623:iam_user:scp_test",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:scp_test:IAM_USER_ACCESS_IAM:cg-sqs-user-cgidic93dfr9ab",
      "src": "288528695623:iam_user:scp_test",
      "dst": "288528695623:iam_user:cg-sqs-user-cgidic93dfr9ab",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:i-073125a3321d8d939:EC2_ACCESS_IGW:igw-0c177eff04906d5d1",
      "src": "288528695623:us-east-1:ec2:i-073125a3321d8d939",
      "dst": "288528695623:us-east-1:igw:igw-0c177eff04906d5d1",
      "relation": "EC2_PUBLIC",
      "directed": false,
      "conditions": "EC2 is assigned a public IP, and the subnet where EC2 is located is connected to an IGW that can communicate externally through the route table."
    },
    {
      "id": "edge:cg-sqs-user-cgidic93dfr9ab:ASSUME_ROLE:cg-sqs-send-message-cgidic93dfr9ab",
      "src": "288528695623:iam_user:cg-sqs-user-cgidic93dfr9ab",
      "dst": "288528695623:iam_role:cg-sqs-send-message-cgidic93dfr9ab",
      "relation": "ASSUME_ROLE",
      "directed": true,
      "conditions": "This is a role that an IAM User can assume."
    },
    {
      "id": "edge:cache-charge-cgidic93dfr9ab:LAMBDA_CALL_EC2:i-073125a3321d8d939",
      "src": "288528695623:us-east-1:lambda:cache-charge-cgidic93dfr9ab",
      "dst": "288528695623:us-east-1:ec2:i-073125a3321d8d939",
      "relation": "LAMBDA_CALL_EC2",
      "directed": true,
      "conditions": "This Lambda function's environment variables contain an EC2 public or private IP address. EC2 is accessible. For more information, check the role associated with the Lambda function."
    },
    {
      "id": "edge:scp_test:IAM_USER_ACCESS_IAM:cg-sqs-send-message-cgidic93dfr9ab",
      "src": "288528695623:iam_user:scp_test",
      "dst": "288528695623:iam_role:cg-sqs-send-message-cgidic93dfr9ab",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:cg-sqs-user-cgidic93dfr9ab:IAM_USER_ASSUME_ROLE:cg-sqs-send-message-cgidic93dfr9ab",
      "src": "288528695623:iam_user:cg-sqs-user-cgidic93dfr9ab",
      "dst": "288528695623:iam_role:cg-sqs-send-message-cgidic93dfr9ab",
      "relation": "IAM_USER_ASSUME_ROLE",
      "directed": true,
      "conditions": "This User can Assume Roles."
    },
    {
      "id": "edge:cg-sqs-user-cgidic93dfr9ab:IAM_USER_ACCESS_IAM:cg-sqs-lambda-cgidic93dfr9ab",
      "src": "288528695623:iam_user:cg-sqs-user-cgidic93dfr9ab",
      "dst": "288528695623:iam_role:cg-sqs-lambda-cgidic93dfr9ab",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:scp_test:IAM_USER_ACCESS_IAM:cg-web-sqs-manager-cgidic93dfr9ab",
      "src": "288528695623:iam_user:scp_test",
      "dst": "288528695623:iam_user:cg-web-sqs-manager-cgidic93dfr9ab",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:cg-sqs-user-cgidic93dfr9ab:IAM_USER_ACCESS_IAM:cg-web-sqs-manager-cgidic93dfr9ab",
      "src": "288528695623:iam_user:cg-sqs-user-cgidic93dfr9ab",
      "dst": "288528695623:iam_user:cg-web-sqs-manager-cgidic93dfr9ab",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:i-073125a3321d8d939:EC2_ACCESS_SQS:cash_charging_queue",
      "src": "288528695623:us-east-1:ec2:i-073125a3321d8d939",
      "dst": "288528695623:us-east-1:sqs:cash_charging_queue",
      "relation": "EC2_ACCESS_SQS",
      "directed": true,
      "conditions": "The user data for the EC2 instance contains the URL of the SQS queue. You can call SQS from EC2. For more information, see Roles Associated with EC2."
    },
    {
      "id": "edge:i-073125a3321d8d939:EC2_ACCESS_RDS:terraform-20260131054208949500000003",
      "src": "288528695623:us-east-1:ec2:i-073125a3321d8d939",
      "dst": "288528695623:us-east-1:rds:terraform-20260131054208949500000003",
      "relation": "EC2_ACCESS_RDS",
      "directed": false,
      "conditions": "The user data for the EC2 instance contains the endpoint of the RDS. You can access RDS from EC2. For more information, see Roles Associated with EC2."
    },
    {
      "id": "edge:cg-sqs-user-cgidic93dfr9ab:IAM_USER_ACCESS_IAM:cg-sqs-send-message-cgidic93dfr9ab",
      "src": "288528695623:iam_user:cg-sqs-user-cgidic93dfr9ab",
      "dst": "288528695623:iam_role:cg-sqs-send-message-cgidic93dfr9ab",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:scp_test:IAM_USER_ACCESS_IAM:cg-sqs-lambda-cgidic93dfr9ab",
      "src": "288528695623:iam_user:scp_test",
      "dst": "288528695623:iam_role:cg-sqs-lambda-cgidic93dfr9ab",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge:cache-charge-cgidic93dfr9ab:ASSUME_ROLE:cg-sqs-lambda-cgidic93dfr9ab",
      "src": "288528695623:us-east-1:lambda:cache-charge-cgidic93dfr9ab",
      "dst": "288528695623:iam_role:cg-sqs-lambda-cgidic93dfr9ab",
      "relation": "ASSUME_ROLE",
      "directed": true,
      "conditions": "A role that a Lambda function can assume."
    }
  ]
}
]
},{
    "id": 2,
    "title": "lambda_privesc",
    "description": "document/lambda_privesc.json",
    "resources": [{
  "nodes": [
    {
      "node_id": "iam_role node id",
      "type": "iam_role",
      "name": "string",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "AWS": "iam_user arn"
              }
            }
          ]
        },
        "inline_policies": [],
        "attached_policies": [
          {
            "PolicyName": "string",
            "Statement": [
              {
                "Action": [
                  "lambda:*",
                  "iam:PassRole"
                ],
                "Effect": "Allow",
                "Resource": "*"
              }
            ]
          }
        ]
      }
    },
    {
      "node_id": "iam_user node id",
      "type": "iam_user",
      "name": "string",
      "properties": {
        "inline_policies": [
          {
            "Effect": "Allow",
            "Action": [
              "sts:AssumeRole"
            ],
            "Resource": "*"
          }
        ],
        "attached_policies": [
          {
            "Effect": "Allow",
            "Action": [
              "iam:List*",
              "iam:Get*"
            ],
            "Resource": "*"
          }
        ],
        "group_policies": []
      }
    },
    {
      "node_id": "iam_role node id",
      "type": "iam_role",
      "name": "string",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ]
        },
        "inline_policies": [],
        "attached_policies": [
          {
            "PolicyName": "AdministratorAccess",
            "Statement": [
              {
                "Action": "*",
                "Effect": "Allow",
                "Resource": "*"
              }
            ]
          }
        ]
      }
    }
  ],
  "edges": [
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_role node id",
      "relation": "ASSUME_ROLE",
      "directed": true,
      "conditions": "This is a role that an IAM User can assume."
    },
    {
      "id": "edge id",
      "src": "iam_role node id",
      "dst": "iam_role node id",
      "relation": "IAM_ROLE_CAN_PASS_ROLE",
      "directed": true,
      "conditions": "This role can pass the target IAM Role (iam:PassRole)."
    },
    {
      "id": "edge id",
      "src": "iam_role node id",
      "dst": "iam_user node id",
      "relation": "IAM_ROLE_ACCESS_IAM",
      "directed": true,
      "conditions": "This role gives you access to IAM."
    },
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_role node id",
      "relation": "IAM_USER_CAN_ASSUME_ROLE",
      "directed": true,
      "conditions": "This user can call sts:AssumeRole on the target role."
    },
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_role node id",
      "relation": "IAM_USER_CAN_ASSUME_ROLE",
      "directed": true,
      "conditions": "This user can call sts:AssumeRole on the target role."
    },
    {
      "id": "edge id",
      "src": "iam_role node id",
      "dst": "iam_role node id",
      "relation": "IAM_ROLE_ACCESS_IAM",
      "directed": true,
      "conditions": "This role gives you access to IAM."
    }
  ]
}
    ]
  },
  {
    "id": 3,
    "title": "iam_privesc_by_key_rotation",
    "description": "document/iam_privesc_by_key_rotation.json",
    "resources": [
 {
  "nodes": [
    {
      "node_id": "node_id",
      "type": "iam_user",
      "name": "string",
      "properties": {
        "inline_policies": [
          {
            "Effect": "Allow",
            "Action": "secretsmanager:ListSecrets",
            "Resource": "*"
          }
        ],
        "attached_policies": [],
        "group_policies": []
      }
    },
    {
      "node_type": "secretsmanager",
      "node_id": "node_id"
    },
    {
      "node_id": "node_id",
      "type": "iam_user",
      "name": "string",
      "properties": {
        "inline_policies": [
          {
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Resource": "*"
          }
        ],
        "attached_policies": [
          {
            "Effect": "Allow",
            "Action": [
              "iam:Get*",
              "iam:List*"
            ],
            "Resource": "*"
          }
        ],
        "group_policies": []
      }
    },
    {
      "node_id": "node_id",
      "type": "iam_role",
      "name": "string",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "AWS": "arn:aws:iam::288528695623:root"
              }
            }
          ]
        },
        "inline_policies": [],
        "attached_policies": [
          {
            "PolicyName": "string",
            "Statement": [
              {
                "Action": "secretsmanager:ListSecrets",
                "Effect": "Allow",
                "Resource": "*"
              },
              {
                "Action": "secretsmanager:GetSecretValue",
                "Effect": "Allow",
                "Resource": "*"
              }
            ]
          }
        ]
      }
    },
    {
      "node_id": "node_id",
      "type": "iam_user",
      "name": "string",
      "properties": {
        "inline_policies": [
          {
            "Effect": "Allow",
            "Action": [
              "iam:DeactivateMFADevice",
              "iam:GetMFADevice",
              "iam:EnableMFADevice",
              "iam:ResyncMFADevice",
              "iam:UpdateAccessKey"
            ],
            "Resource": [
              "arn:aws:iam::288528695623:user/*",
              "arn:aws:iam::288528695623:mfa/*"
            ]
          },
          {
            "Effect": "Allow",
            "Action": [
              "iam:DeleteVirtualMFADevice",
              "iam:CreateVirtualMFADevice"
            ],
            "Resource": "arn:aws:iam::288528695623:mfa/*"
          },
          {
            "Effect": "Allow",
            "Action": [
              "iam:UntagUser",
              "iam:UntagRole",
              "iam:TagRole",
              "iam:UntagMFADevice",
              "iam:UntagPolicy",
              "iam:TagMFADevice",
              "iam:TagPolicy",
              "iam:TagUser"
            ],
            "Resource": "*"
          },
          {
            "Effect": "Allow",
            "Action": [
              "iam:CreateAccessKey",
              "iam:DeleteAccessKey"
            ],
            "Resource": "*"
          }
        ],
        "attached_policies": [
          {
            "Effect": "Allow",
            "Action": [
              "iam:GenerateCredentialReport",
              "iam:GenerateServiceLastAccessedDetails",
              "iam:Get*",
              "iam:List*",
              "iam:SimulateCustomPolicy",
              "iam:SimulatePrincipalPolicy"
            ],
            "Resource": "*"
          }
        ],
        "group_policies": []
      }
    }
  ],
  "edges": [
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_user node id",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_user node id",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_role node id",
      "relation": "IAM_USER_ASSUME_ROLE",
      "directed": true,
      "conditions": "This User can Assume Roles."
    },
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_role node id",
      "relation": "IAM_USER_ACCESS_IAM",
      "directed": true,
      "conditions": "This User has access to IAM."
    },
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "iam_role node id",
      "relation": "IAM_USER_CAN_ASSUME_ROLE",
      "directed": true,
      "conditions": "This user can call sts:AssumeRole on the target role."
    },
    {
      "id": "edge id",
      "src": "iam_role node id",
      "dst": "secretsmanager node id",
      "relation": "IAM_ROLE_ACCESS_SECRETSMANAGER",
      "directed": true,
      "conditions": "This role gives you access to Secrets Manager."
    },
    {
      "id": "edge id",
      "src": "iam_user node id",
      "dst": "secretsmanager node id",
      "relation": "IAM_USER_ACCESS_SECRETSMANAGER",
      "directed": true,
      "conditions": "This User has access to Secrets Manager."
    }
  ]
}
    ]
  },
    {
    "id": 4,
    "title": "ecs_take_over",
    "description": "document/ecs_take_over.json",
    "resources": [
      {
  "schema_version": "1.5",
  "nodes": [
    {
      "node_id": "288528695623:us-east-1:ecs_task:0f6353dd0a8b4128899f715db6724cab",
      "type": "ecs_task",
      "name": "privd",
      "properties": {
        "cluster_name": "ecs-takeover-cgid33k7dvei2d-cluster",
        "host_instance_id": "i-0eb52e49428733ca0",
        "launch_type": "EC2",
        "has_docker_socket": false,
        "containers": [
          {
            "name": "privd",
            "image": "busybox:latest",
            "cpu": "50",
            "memory": "50"
          }
        ]
      }
    },
    {
      "node_id": "288528695623:us-east-1:ecs_task:60342375896846f2a61a6cb1ba28039a",
      "type": "ecs_task",
      "name": "vault",
      "properties": {
        "cluster_name": "ecs-takeover-cgid33k7dvei2d-cluster",
        "host_instance_id": "i-0eb52e49428733ca0",
        "launch_type": "EC2",
        "has_docker_socket": false,
        "containers": [
          {
            "name": "vault",
            "image": "busybox:latest",
            "cpu": "50",
            "memory": "50"
          }
        ]
      }
    },
    {
      "node_id": "288528695623:us-east-1:ec2_instance:i-0eb52e49428733ca0",
      "type": "ec2",
      "name": "cg-ecs-takeover-cgid33k7dvei2d-vault"
    },
    {
      "node_id": "288528695623:iam_role:AROA5GXM3PEBDYX56YGFS",
      "type": "iam_role",
      "name": "cg-ecs-takeover-cgid33k7dvei2d-privd",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "Service": "ecs-tasks.amazonaws.com"
              }
            }
          ]
        },
        "inline_policies": [],
        "attached_policies": [
          {
            "PolicyName": "cg-ecs-takeover-cgid33k7dvei2d-privd",
            "Statement": [
              {
                "Action": [
                  "ecs:ListServices",
                  "ecs:ListTasks",
                  "ecs:DescribeServices",
                  "ecs:ListContainerInstances",
                  "ecs:DescribeContainerInstances",
                  "ecs:DescribeTasks",
                  "ecs:ListTaskDefinitions",
                  "ecs:DescribeClusters",
                  "ecs:ListClusters",
                  "iam:GetPolicyVersion",
                  "iam:GetPolicy",
                  "iam:ListAttachedRolePolicies",
                  "iam:GetRolePolicy"
                ],
                "Effect": "Allow",
                "Resource": "*"
              }
            ]
          }
        ]
      }
    },
    {
      "node_id": "288528695623:us-east-1:ecs_task:d66e62968799454da932464fa93aab0d",
      "type": "ecs_task",
      "name": "privd",
      "properties": {
        "cluster_name": "ecs-takeover-cgid33k7dvei2d-cluster",
        "host_instance_id": "i-0856ceb64ac199e09",
        "launch_type": "EC2",
        "has_docker_socket": false,
        "containers": [
          {
            "name": "privd",
            "image": "busybox:latest",
            "cpu": "50",
            "memory": "50"
          }
        ]
      }
    },
    {
      "node_id": "288528695623:iam_role:AROA5GXM3PEBICPNGAVNZ",
      "type": "iam_role",
      "name": "cg-ecs-takeover-cgid33k7dvei2d-ecs-agent",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "Service": "ec2.amazonaws.com"
              }
            }
          ]
        },
        "inline_policies": [],
        "attached_policies": [
          {
            "PolicyName": "AmazonEC2ContainerServiceforEC2Role",
            "Statement": [
              {
                "Action": [
                  "ec2:DescribeTags",
                  "ecs:CreateCluster",
                  "ecs:DeregisterContainerInstance",
                  "ecs:DiscoverPollEndpoint",
                  "ecs:Poll",
                  "ecs:RegisterContainerInstance",
                  "ecs:StartTelemetrySession",
                  "ecs:UpdateContainerInstancesState",
                  "ecs:Submit*",
                  "ecr:GetAuthorizationToken",
                  "ecr:BatchCheckLayerAvailability",
                  "ecr:GetDownloadUrlForLayer",
                  "ecr:BatchGetImage",
                  "logs:CreateLogStream",
                  "logs:PutLogEvents"
                ],
                "Effect": "Allow",
                "Resource": "*"
              },
              {
                "Action": "ecs:TagResource",
                "Effect": "Allow",
                "Resource": "*"
              },
              {
                "Action": [
                  "ecs:ListTagsForResource"
                ],
                "Effect": "Allow",
                "Resource": [
                  "arn:aws:ecs:*:*:task/*/*",
                  "arn:aws:ecs:*:*:container-instance/*/*"
                ]
              }
            ]
          }
        ]
      }
    },
    {
      "node_id": "288528695623:us-east-1:ec2_instance:i-0856ceb64ac199e09",
      "type": "ec2",
      "name": "cg-ecs-takeover-cgid33k7dvei2d-vulnsite"
    },
    {
      "node_id": "288528695623:us-east-1:ecs_task:aa159ebd8a4f49e88535ece9be6b99f3",
      "type": "ecs_task",
      "name": "vulnsite",
      "properties": {
        "cluster_name": "ecs-takeover-cgid33k7dvei2d-cluster",
        "host_instance_id": "i-0856ceb64ac199e09",
        "launch_type": "EC2",
        "has_docker_socket": true,
        "containers": [
          {
            "name": "vulnsite",
            "image": "cloudgoat/ecs-takeover-vulnsite:latest",
            "cpu": "256",
            "memory": "256"
          }
        ]
      }
    }
  ],
  "edges": [
    {
      "id": "edge_3",
      "src": "288528695623:us-east-1:ecs_task:0f6353dd0a8b4128899f715db6724cab",
      "dst": "288528695623:us-east-1:ec2_instance:i-0eb52e49428733ca0",
      "relation": "runs_on",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_4",
      "src": "288528695623:us-east-1:ecs_task:0f6353dd0a8b4128899f715db6724cab",
      "dst": "288528695623:iam_role:AROA5GXM3PEBDYX56YGFS",
      "relation": "has_task_role",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_5",
      "src": "288528695623:us-east-1:ecs_task:60342375896846f2a61a6cb1ba28039a",
      "dst": "288528695623:us-east-1:ec2_instance:i-0eb52e49428733ca0",
      "relation": "runs_on",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_7",
      "src": "288528695623:us-east-1:ecs_task:d66e62968799454da932464fa93aab0d",
      "dst": "288528695623:us-east-1:ec2_instance:i-0856ceb64ac199e09",
      "relation": "runs_on",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_6",
      "src": "288528695623:us-east-1:ecs_task:aa159ebd8a4f49e88535ece9be6b99f3",
      "dst": "288528695623:us-east-1:ec2_instance:i-0856ceb64ac199e09",
      "relation": "runs_on",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_2",
      "src": "288528695623:us-east-1:ec2_instance:i-0856ceb64ac199e09",
      "dst": "288528695623:iam_role:AROA5GXM3PEBICPNGAVNZ",
      "relation": "has_iam_role",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_8",
      "src": "288528695623:us-east-1:ecs_task:d66e62968799454da932464fa93aab0d",
      "dst": "288528695623:iam_role:AROA5GXM3PEBDYX56YGFS",
      "relation": "has_task_role",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_1",
      "src": "288528695623:us-east-1:ec2_instance:i-0eb52e49428733ca0",
      "dst": "288528695623:iam_role:AROA5GXM3PEBICPNGAVNZ",
      "relation": "has_iam_role",
      "directed": true,
      "conditions": []
    }
  ]
}
    ]
  },
  {
    "id": 5,
    "title": "vulnerable_lambda",
    "description": "document/vulnerable_lambda.json",
    "resources": [
      {
  "schema_version": "1.5",
  "nodes": [
    {
      "node_id": "288528695623:iam_role:AROA5GXM3PEBPXUOICJVK",
      "type": "iam_role",
      "name": "cg-lambda-invoker-cgidqr0pwai050",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "AWS": "arn:aws:iam::288528695623:user/cg-bilbo-cgidqr0pwai050"
              }
            }
          ]
        },
        "inline_policies": [
          {
            "PolicyName": "lambda-invoker",
            "Statement": [
              {
                "Action": [
                  "lambda:ListFunctionEventInvokeConfigs",
                  "lambda:InvokeFunction",
                  "lambda:ListTags",
                  "lambda:GetFunction",
                  "lambda:GetPolicy"
                ],
                "Effect": "Allow",
                "Resource": "arn:aws:lambda:us-east-1:288528695623:function:cgidqr0pwai050-policy_applier_lambda1"
              },
              {
                "Action": [
                  "lambda:ListFunctions",
                  "iam:Get*",
                  "iam:List*",
                  "iam:SimulateCustomPolicy",
                  "iam:SimulatePrincipalPolicy"
                ],
                "Effect": "Allow",
                "Resource": "*"
              }
            ]
          }
        ],
        "attached_policies": []
      }
    },
    {
      "node_id": "288528695623:iam_user:AIDA5GXM3PEBNIW6X2Z4G",
      "type": "iam_user",
      "name": "cg-bilbo-cgidqr0pwai050",
      "properties": {
        "inline_policies": [
          {
            "Effect": "Allow",
            "Action": "sts:AssumeRole",
            "Resource": "arn:aws:iam::940877411605:role/cg-lambda-invoker*"
          },
          {
            "Effect": "Allow",
            "Action": [
              "iam:Get*",
              "iam:List*",
              "iam:SimulateCustomPolicy",
              "iam:SimulatePrincipalPolicy"
            ],
            "Resource": "*"
          }
        ],
        "attached_policies": [],
        "group_policies": []
      }
    },
    {
      "node_id": "288528695623:iam_role:AROA5GXM3PEBPE26GKYSY",
      "type": "iam_role",
      "name": "cgidqr0pwai050-policy_applier_lambda1",
      "properties": {
        "assume_role_policy": {
          "Statement": [
            {
              "Effect": "Allow",
              "Action": "sts:AssumeRole",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ]
        },
        "inline_policies": [
          {
            "PolicyName": "policy_applier_lambda1",
            "Statement": [
              {
                "Action": "iam:AttachUserPolicy",
                "Effect": "Allow",
                "Resource": "arn:aws:iam::288528695623:user/cg-bilbo-cgidqr0pwai050"
              },
              {
                "Action": [
                  "logs:CreateLogStream",
                  "logs:PutLogEvents"
                ],
                "Effect": "Allow",
                "Resource": "arn:aws:logs:us-east-1:288528695623:log-group:/aws/lambda/cgidqr0pwai050-policy_applier_lambda1:*"
              }
            ]
          }
        ],
        "attached_policies": []
      }
    },
    {
      "node_id": "288528695623:us-east-1:secretsmanager:cgidqr0pwai050-final_flag",
      "type": "secretsmanager",
      "name": "cgidqr0pwai050-final_flag",
      "properties": {
        "arn": "arn:aws:secretsmanager:us-east-1:288528695623:secret:cgidqr0pwai050-final_flag-hN8Pks",
        "description": ""
      }
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "src": "288528695623:iam_user:AIDA5GXM3PEBNIW6X2Z4G",
      "dst": "288528695623:iam_role:AROA5GXM3PEBPXUOICJVK",
      "relation": "can_assume_role",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_2",
      "src": "288528695623:iam_role:AROA5GXM3PEBPE26GKYSY",
      "dst": "288528695623:iam_user:AIDA5GXM3PEBNIW6X2Z4G",
      "relation": "can_attach_policy_to",
      "directed": true,
      "conditions": []
    },
    {
      "id": "edge_3",
      "src": "288528695623:iam_user:AIDA5GXM3PEBNIW6X2Z4G",
      "dst": "288528695623:us-east-1:secretsmanager:cgidqr0pwai050-final_flag",
      "relation": "can_access_after_privesc",
      "directed": true,
      "conditions": [
        "requires_admin_policy"
      ]
    }
  ]
}
    ]
  }
]